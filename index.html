<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadoras Educativas Pro</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://www.desmos.com/api/v1.8/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/12.4.1/math.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;700&display=swap');
        :root {
            --color-black: #000000;
            --color-red: #FF0000;
            --color-white: #FFFFFF;
            --font-tech: 'Rajdhani', sans-serif;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background-color: var(--color-black);
            color: var(--color-white);
            font-family: var(--font-tech);
            min-height: 100vh;
            background-image: radial-gradient(circle at 1px 1px, rgba(255, 0, 0, 0.2) 1px, transparent 0);
            background-size: 20px 20px;
        }
        header { text-align: center; padding: 40px 20px; }
        header h1 {
            font-size: 3rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--color-white);
            text-shadow: 0 0 10px var(--color-red), 0 0 20px var(--color-red), 0 0 30px var(--color-red);
            animation: flicker 1.5s infinite alternate;
        }
        @keyframes flicker {
          0%, 18%, 22%, 25%, 53%, 57%, 100% { text-shadow: 0 0 4px var(--color-white), 0 0 10px var(--color-red), 0 0 18px var(--color-red); }
          20%, 24%, 55% { text-shadow: none; }
        }
        header p { font-size: 1.2rem; color: #ccc; margin-top: 10px; }
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            padding: 20px 40px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .card {
            background: #0a0a0a;
            border: 1px solid var(--color-red);
            padding: 30px;
            text-align: center;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.4);
        }
        .card:hover { transform: translateY(-10px) scale(1.03); box-shadow: 0 0 30px rgba(255, 0, 0, 0.8); }
        .card-icon { font-size: 3rem; color: var(--color-red); margin-bottom: 20px; text-shadow: 0 0 15px var(--color-red); }
        .card h3 { font-size: 1.8rem; margin-bottom: 10px; font-weight: 700; }
        .card p { font-size: 1rem; color: #aaa; }
        footer { text-align: center; padding: 30px 20px; font-size: 1rem; color: #888; }
        
        /* Estilos del Modal */
        .hidden { display: none !important; }
        #modal-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.85); display: flex; align-items: center;
            justify-content: center; z-index: 1000; animation: fadeIn 0.3s ease;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal-content {
            background: var(--color-black); width: 95%; max-width: 900px; height: 90vh;
            padding: 20px 30px; border-radius: 10px; border: 1px solid var(--color-red);
            box-shadow: 0 0 40px rgba(255, 0, 0, 0.6); position: relative;
            display: flex; flex-direction: column;
        }
        .close-button {
            position: absolute; top: 15px; right: 20px; font-size: 2.5rem;
            color: var(--color-white); cursor: pointer; transition: color 0.2s;
        }
        .close-button:hover { color: var(--color-red); }
        #modal-title { font-size: 2rem; margin-bottom: 15px; color: var(--color-red); text-align: center; }
        .calculator-body { display: flex; flex-direction: column; flex-grow: 1; min-height: 0; }
        .input-section { display: flex; gap: 15px; align-items: center; margin-bottom: 15px; }
        #equation-input {
            flex-grow: 1; padding: 12px; font-size: 1.1rem; background: #1a1a1a;
            border: 1px solid #555; border-radius: 5px; color: var(--color-white); font-family: var(--font-tech);
        }
        #equation-input:focus { outline: none; border-color: var(--color-red); box-shadow: 0 0 10px rgba(255, 0, 0, 0.5); }
        #calculate-button {
            padding: 12px 25px; font-size: 1.1rem; background-color: var(--color-red);
            color: var(--color-white); border: none; border-radius: 5px; cursor: pointer;
            font-family: var(--font-tech); font-weight: 700; transition: background-color 0.3s, transform 0.2s;
        }
        #calculate-button:hover { background-color: #c00; transform: scale(1.05); }
        .results-container { overflow-y: auto; padding-right: 15px; }
        .result-block {
            background: #0a0a0a; border: 1px solid #333; border-radius: 8px;
            margin-bottom: 20px; padding: 20px;
        }
        .result-block h4 { font-size: 1.5rem; color: var(--color-red); margin-bottom: 15px; border-bottom: 1px solid var(--color-red); padding-bottom: 10px; }
        .result-block p, .result-block li { color: #ccc; line-height: 1.6; }
        .result-block ul { list-style-position: inside; padding-left: 10px; }
        .result-block code {
            background-color: #1c1c1c; padding: 3px 6px; border-radius: 4px;
            color: #f89898; font-family: 'Courier New', Courier, monospace;
        }
        #calculator-graph-container { height: 400px; width: 100%; }
    </style>
</head>
<body>

    <header>
        <h1>Calculadoras Educativas Pro</h1>
        <p>Utiliza estas herramientas para comprender tus clases de cálculo</p>
    </header>

    <main class="grid-container">
        <div class="card" data-calculator="ecuaciones"><i class="fas fa-equals card-icon"></i><h3>Ecuaciones</h3><p>Resuelve, analiza y grafica funciones algebraicas.</p></div>
        <div class="card" data-calculator="inecuaciones"><i class="fas fa-less-than-equal card-icon"></i><h3>Inecuaciones</h3><p>Encuentra soluciones en intervalos y visualízalas.</p></div>
        <div class="card" data-calculator="limites"><i class="fa-solid fa-infinity card-icon"></i><h3>Límites</h3><p>Calcula el comportamiento de funciones en puntos o al infinito.</p></div>
        <div class="card" data-calculator="exponenciales"><i class="fa-solid fa-e card-icon"></i><h3>Exponenciales</h3><p>Resuelve y grafica funciones exponenciales.</p></div>
        <div class="card" data-calculator="logaritmos"><i class="fa-solid fa-L card-icon"></i><h3>Logaritmos</h3><p>Resuelve y grafica funciones logarítmicas.</p></div>
        <div class="card" data-calculator="derivadas"><i class="fa-solid fa-square-root-variable card-icon"></i><h3>Derivadas</h3><p>Calcula derivadas, encuentra puntos críticos y tangentes.</p></div>
        <div class="card" data-calculator="integrales"><i class="fa-solid fa-chart-area card-icon"></i><h3>Integrales</h3><p>Calcula el área bajo la curva y la antiderivada.</p></div>
    </main>

    <footer>
        <p>Creado por Marco Steven Ruiz</p>
    </footer>

    <div id="modal-container" class="hidden">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="modal-title">Título de la Calculadora</h2>
            <div class="calculator-body">
                <div class="input-section">
                    <input type="text" id="equation-input" placeholder="Escribe tu función aquí...">
                    <button id="calculate-button">Calcular</button>
                </div>
                <div class="results-container" id="results-output">
                    </div>
            </div>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const cards = document.querySelectorAll('.card');
        const modalContainer = document.getElementById('modal-container');
        const modalTitle = document.getElementById('modal-title');
        const closeButton = document.querySelector('.close-button');
        const calculateButton = document.getElementById('calculate-button');
        const equationInput = document.getElementById('equation-input');
        const resultsOutput = document.getElementById('results-output');

        let desmosCalculator;

        const calculatorInfo = {
            ecuaciones: { title: "Calculadora de Ecuaciones", placeholder: "x^2 - 4" },
            inecuaciones: { title: "Calculadora de Inecuaciones", placeholder: "x^2 - 4 > 0" },
            limites: { title: "Calculadora de Límites", placeholder: "(x^2-1)/(x-1) para x=1" },
            exponenciales: { title: "Calculadora Exponencial", placeholder: "2^x - 8" },
            logaritmos: { title: "Calculadora Logarítmica", placeholder: "log(x, 2) - 3" },
            derivadas: { title: "Calculadora de Derivadas", placeholder: "x^3 - 3x" },
            integrales: { title: "Calculadora de Integrales", placeholder: "x^2 de 0 a 2" }
        };

        cards.forEach(card => card.addEventListener('click', () => openModal(card.dataset.calculator)));
        
        function openModal(type) {
            const info = calculatorInfo[type];
            modalTitle.textContent = info.title;
            equationInput.placeholder = `Ej: ${info.placeholder}`;
            modalContainer.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            equationInput.value = '';
            resultsOutput.innerHTML = '';
        }

        function closeModal() {
            modalContainer.classList.add('hidden');
            document.body.style.overflow = 'auto';
            if (desmosCalculator) {
                desmosCalculator.destroy();
                desmosCalculator = null;
            }
        }
        closeButton.addEventListener('click', closeModal);
        modalContainer.addEventListener('click', e => e.target === modalContainer && closeModal());

        calculateButton.addEventListener('click', () => {
            const type = Object.keys(calculatorInfo).find(key => calculatorInfo[key].title === modalTitle.textContent);
            const input = equationInput.value;
            if (!input) {
                resultsOutput.innerHTML = `<p style="color: #ff5555;">Por favor, introduce una expresión.</p>`;
                return;
            }

            // Estructura base para los resultados
            resultsOutput.innerHTML = `
                <div class="result-block" id="paso-a-paso"><h4>1. Proceso Paso a Paso</h4></div>
                <div class="result-block" id="caracteristicas"><h4>2. Características</h4></div>
                <div class="result-block" id="grafica"><h4>3. Gráfica Interactiva</h4><div id="calculator-graph-container"></div></div>
                <div class="result-block" id="analisis"><h4>4. Análisis Final</h4></div>
            `;
            
            // Inicializar Desmos en el nuevo contenedor
            if (desmosCalculator) desmosCalculator.destroy();
            const graphContainer = document.getElementById('calculator-graph-container');
            desmosCalculator = Desmos.GraphingCalculator(graphContainer, { keypad: true, expressions: false, settingsMenu: true, zoomButtons: true });

            try {
                switch (type) {
                    case 'ecuaciones': calculateEcuaciones(input); break;
                    case 'derivadas': calculateDerivadas(input); break;
                    case 'integrales': calculateIntegrales(input); break;
                    // Añadir llamadas a otras calculadoras aquí
                    default:
                        document.getElementById('paso-a-paso').innerHTML += `<p>La lógica para esta calculadora aún está en desarrollo.</p>`;
                        desmosCalculator.setExpression({ id: 'graph', latex: input.split('=')[0].split('>')[0].split('<')[0] });
                }
            } catch (error) {
                resultsOutput.innerHTML = `<p style="color: #ff5555; font-size: 1.2rem;">Error: ${error.message}. Revisa la sintaxis de tu expresión.</p>`;
            }
        });

        // --- LÓGICA DE LAS CALCULADORAS ---

        function calculateEcuaciones(input) {
            const expr = input.replace(/y\s*=/,'').trim();
            const node = math.parse(expr);
            
            // 1. Paso a Paso
            let pasoHtml = `<p>Para resolver la ecuación <code>${expr} = 0</code>, buscamos los valores de 'x' que hacen la expresión igual a cero.</p>`;
            try {
                const roots = math.rationalize(node).getRoots();
                pasoHtml += `<p>Usando métodos algebraicos, encontramos las siguientes raíces:</p><ul>`;
                roots.forEach(root => pasoHtml += `<li><code>x = ${math.format(root, {precision: 4})}</code></li>`);
                pasoHtml += `</ul>`;
            } catch (e) {
                pasoHtml += `<p>No se pudo resolver simbólicamente de forma directa. La gráfica nos ayudará a encontrar las raíces de forma numérica.</p>`;
            }
            document.getElementById('paso-a-paso').innerHTML += pasoHtml;

            // 2. Características
            const yIntercept = node.evaluate({x: 0});
            let caracHtml = `<ul>
                <li><strong>Dominio:</strong> Para la mayoría de los polinomios, el dominio es todos los números reales (ℝ).</li>
                <li><strong>Intersección Eje Y:</strong> La gráfica corta el eje Y en <code>y = ${math.format(yIntercept, {precision: 4})}</code>.</li>
            </ul>`;
            document.getElementById('caracteristicas').innerHTML += caracHtml;

            // 3. Gráfica
            desmosCalculator.setExpression({ id: 'func', latex: `y=${expr}`, color: Desmos.Colors.RED });
            desmosCalculator.setExpression({ id: 'zeroline', latex: `y=0` });

            // 4. Análisis
            document.getElementById('analisis').innerHTML += `<p>La gráfica muestra el comportamiento de la función. Las raíces de la ecuación son los puntos donde la curva roja cruza la línea horizontal (eje X). La intersección con el eje Y es el punto donde la curva cruza el eje vertical.</p>`;
        }

        function calculateDerivadas(input) {
            const node = math.parse(input);

            // 1. Paso a Paso
            let pasoHtml = `<h5>Método Largo (Definición de Límite)</h5>
            <p>La derivada se define como: <code>f'(x) = lim(h→0) [f(x+h) - f(x)] / h</code></p>
            <p>Para <code>f(x) = ${input}</code>, si aplicáramos este proceso (que puede ser muy largo), obtendríamos el resultado final.</p>
            <h5>Método Corto (Reglas de Derivación)</h5>`;
            const derivative = math.derivative(node, 'x');
            const simplifiedDerivative = math.simplify(derivative);
            pasoHtml += `<p>Aplicando las reglas de derivación (potencia, producto, cadena, etc.), obtenemos:</p>
            <p><code>f'(x) = ${simplifiedDerivative.toString()}</code></p>`;
            document.getElementById('paso-a-paso').innerHTML += pasoHtml;

            // 2. Características
            let caracHtml = `<ul><li><strong>Función Original:</strong> <code>f(x) = ${input}</code></li>
                                <li><strong>Función Derivada:</strong> <code>f'(x) = ${simplifiedDerivative.toString()}</code></li>`;
            try {
                const criticalPoints = math.rationalize(simplifiedDerivative).getRoots();
                caracHtml += `<li><strong>Puntos Críticos (donde f'(x)=0):</strong><ul>`;
                criticalPoints.forEach(p => caracHtml += `<li><code>x = ${math.format(p, {precision: 4})}</code></li>`);
                caracHtml += `</ul>Estos son candidatos para máximos o mínimos locales.</li>`;
            } catch(e) {
                caracHtml += `<li><strong>Puntos Críticos:</strong> No se pudieron determinar simbólicamente.</li>`;
            }
            caracHtml += `</ul>`;
            document.getElementById('caracteristicas').innerHTML += caracHtml;

            // 3. Gráfica
            desmosCalculator.setExpression({ id: 'func', latex: `y=${input}`, color: Desmos.Colors.RED, label: 'f(x)' });
            desmosCalculator.setExpression({ id: 'deriv', latex: `y=${simplifiedDerivative.toString()}`, color: Desmos.Colors.BLUE, label: "f'(x)" });

            // 4. Análisis
            document.getElementById('analisis').innerHTML += `<p>La gráfica roja es la función original <code>f(x)</code>. La gráfica azul es su derivada <code>f'(x)</code>. Observa que cuando la gráfica roja alcanza un máximo o un mínimo (un "pico" o un "valle"), la gráfica azul cruza el eje X (es decir, la derivada es cero). Donde <code>f'(x)</code> es positiva, <code>f(x)</code> es creciente, y donde es negativa, <code>f(x)</code> es decreciente.</p>`;
        }
        
        function calculateIntegrales(input) {
            const [expr, ...bounds] = input.replace(/de/g, '').split(/\s+/).filter(Boolean);
            const isDefinite = bounds.length === 2 && !isNaN(bounds[0]) && !isNaN(bounds[1]);
            const node = math.parse(expr);

            // 1. Paso a Paso
            let pasoHtml = `<h5>Antiderivada (Integral Indefinida)</h5>
            <p>Buscamos una función <code>F(x)</code> tal que <code>F'(x) = f(x)</code>. Para <code>f(x) = ${expr}</code>, aplicando la regla inversa de la potencia (y otras), la antiderivada es:</p>`;
            // Math.js no tiene integración simbólica, lo simulamos para polinomios simples
            let antiderivativeStr = "No se pudo calcular simbólicamente";
            try {
                 antiderivativeStr = math.integral(expr, 'x').toString() + " + C";
                 pasoHtml += `<code>F(x) = ${antiderivativeStr}</code>`;
            } catch (e) {
                pasoHtml += `<code>${antiderivativeStr}</code>. Esta es una operación compleja.`;
            }
            
            if (isDefinite) {
                const a = parseFloat(bounds[0]);
                const b = parseFloat(bounds[1]);
                pasoHtml += `<h5>Integral Definida de ${a} a ${b}</h5>
                <p>Usamos el Teorema Fundamental del Cálculo: <code>∫f(x)dx = F(b) - F(a)</code>.</p>`;
                try {
                    const integralValue = math.integral(expr, 'x', a, b);
                    pasoHtml += `<p>El resultado del área es: <code>${math.format(integralValue, {precision: 5})}</code></p>`;
                } catch(e) {
                     pasoHtml += `<p>No se pudo calcular el valor numérico.</p>`;
                }
            }
            document.getElementById('paso-a-paso').innerHTML += pasoHtml;
            
            // 2. Características
            let caracHtml = `<ul><li><strong>Función a integrar:</strong> <code>f(x) = ${expr}</code></li>
                                 <li><strong>Tipo:</strong> ${isDefinite ? 'Definida' : 'Indefinida'}</li>`;
            if (isDefinite) caracHtml += `<li><strong>Límites de integración:</strong> de <code>x=${bounds[0]}</code> a <code>x=${bounds[1]}</code></li>`;
            caracHtml += `</ul>`;
            document.getElementById('caracteristicas').innerHTML += caracHtml;

            // 3. Gráfica
            desmosCalculator.setExpression({ id: 'func', latex: `y=${expr}`, color: Desmos.Colors.RED });
            if (isDefinite) {
                desmosCalculator.setExpression({ id: 'area', latex: `0 < y < ${expr}`, color: Desmos.Colors.RED, lines: false, fillOpacity: 0.4, domain: { min: bounds[0], max: bounds[1] } });
            }

            // 4. Análisis
            let analisisHtml = `<p>La integral indefinida representa una familia de funciones (la antiderivada). `;
            if(isDefinite) {
                analisisHtml += `La integral definida calcula el 'área neta' bajo la curva <code>f(x)</code> entre los límites de integración. El área sombreada en la gráfica visualiza este valor. Si la función está por debajo del eje X, el área se cuenta como negativa.`;
            } else {
                analisisHtml += `Su gráfica sería una curva cuya pendiente en cualquier punto 'x' es igual al valor de <code>f(x)</code>.`;
            }
            document.getElementById('analisis').innerHTML += analisisHtml;
        }

    });
    </script>

</body>
</html>
